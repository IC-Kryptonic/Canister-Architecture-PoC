@startuml
activate Frontend
alt targeted
    Frontend -> AdManager: get_ad_principal_for_user(user_principal)
    activate AdManager

    ProfileBackend <- AdManager: get_profile(user_principal)
    activate ProfileBackend
    AdManager <-- ProfileBackend: get_profile: profile
    deactivate ProfileBackend

    AdManager --> Frontend: get_ad_principal_for_user: ad_principal
    deactivate AdManager

else random
    Frontend -> AdManager: get_random_ad_principal()
    activate AdManager
    AdManager --> Frontend: get_random_ad_principal: ad_principal
    deactivate AdManager
end

Frontend -> VideoCanister: get_info()
activate VideoCanister
VideoCanister --> Frontend: get_info: video_info
deactivate VideoCanister

loop chunk_num times
    Frontend -> VideoCanister: get_chunk(#)
    activate VideoCanister
    Frontend <-- VideoCanister: get_chunk: chunk
    deactivate VideoCanister
end

@enduml